---
order: 2
category: math
tag: 线性代数
star: false
sticky: false
excerpt: '线性代数-矩阵消元'
---

# :boat:矩阵消元
对于一般的方程组而言，我们不使用上一节画图的方法来求解，那样太麻烦了，对于行图像需要画出每个方程的图像，然后求交点，而对于列图像，则是寻找向量的线性组合，这样的方法太麻烦了，我们需要一种更加简单的方法来求解方程组，这就是矩阵消元法。消元法是计算机软件求解线形方程组所用的最常见的方法。任何情况下，只要是矩阵A可逆，均可以通过消元法求得`Ax=b`的解。

我们给出线性方程组为
$$
A=\begin{bmatrix} 1&2&1\\3&8&1\\0&4&1 \end{bmatrix}b=\begin{bmatrix} 2\\12\\2 \end{bmatrix}
$$


## 高斯消元法
上面的形式中，矩阵A是方程组的系数矩阵，b是方程组的解向量

高斯消元法就是通过对方程组中某两个方程进行适当的数乘和加法，使某个未知数的系数变为0，从而消减未知数的个数，直到最后只剩下一个未知数，然后通过回代求解出最后一个未知数，从而求出方程组的解。
### 消元
我们将矩阵左上角的1称之为“主元一”（the first pivot），第一步要通过消元将第一列中除了主元之外的数字均变化为0。操作方法就是用之后的每一行减去第一行的适当倍数，此例中第二行应减去第一行的3倍。之后应对第三行做类似操作，本例中三行第一列数字已经为0，故不用进行操作。

![](/math/6.webp =500x)

处在第二行第二列的主元二为2，因此用第三行减去第二行的两倍进行消元，得到第三个主元为5。

矩阵A为可逆矩阵，消元结束后得到上三角阵U（Uppertriangular matrix），其左侧下半部分的元素均为0，而主元1,2,5分列在U的对角线上。主元之积即行列式的值。

需要说明的是，主元不能为0，如果恰好消元至某行，0出现在了主元的位置上，应当通过与下方一行进行“行交换”使得非零数字出现在主元位置上。如果0出现在了主元位置上，并且下方没有对等位置为非0数字的行，则消元终止，并证明矩阵A为不可逆矩阵，且线性方程组没有唯一解。

例如消元成这样 $\begin{bmatrix} *&*&* \\ 0&*&*  \\ 0&0&0 \end{bmatrix}$  由于在回代时会使得某个未知数的系数为0，因此无法求解。

### 回代
做方程的高斯消元时，需要对等式右侧的**b**做同样的乘法和加减法。手工计算时比较有效率的方法是应用`增广矩阵`（augmented matrix），将**b**插入矩阵**A**之后形成最后一列，在消元过程中带着**b**一起操作。（Matlab是算完系数矩阵再处理**b**的。）

![](/math/7.png =700x)

此时我们将 $Ax=b$转化成了新的方程 $Ux=c$
$$
\begin{bmatrix} 1&2&1\\0&2&-2\\0&0&5 \end{bmatrix} \begin{bmatrix} x\\ y\\ z \end{bmatrix} = \begin{bmatrix} 2\\6\\-10 \end{bmatrix}
$$

从最后一行开始，我们可以直接得到 $z=-2$，然后代入第二行，得到 $y=1$，最后代入第一行，得到 $x=1$，因此方程组的解为 $\begin{bmatrix} 1\\1\\-2 \end{bmatrix}$


::: info
以上我们对矩阵进行的操作其实就是求线性方程组的步骤。在线性代数中比较重要的就是将之前所说的“第二行减去第一行的3倍”这种操作条例变为矩阵化的数学语言。这样我们就可以将对线性方程组的求解转化为对矩阵的操作，从而可以使用计算机来求解线性方程组。

:::


## 消元矩阵

对于我们人来说，我们可以通过对方程进行消元来求解线性方程组，但是对于计算机来说，它只能通过矩阵乘法来进行计算，因此我们需要将消元的操作转化为矩阵乘法的形式，这样计算机才能够进行计算。

在前面我们已经展示了矩阵消元的过程，我们可以将消元的过程转化为矩阵乘法的形式，这样我们就可以使用矩阵乘法来进行消元，从而求解线性方程组。

矩阵运算的核心内容就是对`行`或`列`进行独立操作。

在前一节中，我们知道了一个矩阵乘以一个列向量，相当于对矩阵的每一行进行线性组合，得到的结果就是一个列向量。

![](/math/8.png =600x)

与之相对成，矩阵左乘行向量则是对矩阵的每一列进行线性组合，得到的结果就是一个行向量。

![](/math/9.png =600x)


好了  有了一些基础知识我们就开始把消元的过程转化为矩阵乘法的形式。(也就是将"第二行减去第一行的3倍"这样只有人类能看懂的语言转化为计算机能懂的矩阵的运算)

![](/math/6.webp =500x)

回顾一下我们的第一步，将第二行减去第一行的3倍，转化为矩阵的形式就是让 $\begin{bmatrix} 1&2&1\\3&8&1\\0&4&1 \end{bmatrix}$ 乘上一个矩阵，结果是 $\begin{bmatrix} 1&2&1\\0&2&-2\\0&4&1 \end{bmatrix}$。结合前面的左乘行向量得到行向量的知识，我们可以一行一行得到我们的结果。

- 第一行:

![](/math/10.png =470x)

- 第三行:

![](/math/11.png =500x)

- 最重要的第二行:

![](/math/12.png =600x)

这样我们就得到了结果矩阵的每一行，将这些行向量组合起来就是我们的结果矩阵。

![](/math/13.png =600x)

我们看看左边那个矩阵，若把`-3`去掉，就变成了 $\begin{bmatrix} 1&0&0\\0&1&0\\0&0&1 \end{bmatrix}$，我们称这个矩阵为单位矩阵(`E`)，相当于数字中的`1`。这个矩阵的作用就是让矩阵不变，相当于乘以1。

当我们对这个单位矩阵进行初等行变换(后面会学滴)，就会得到我们的消元矩阵，我们称这个矩阵为初等矩阵。

我们的第一步操作`将第二行减去第一行的3倍`，就被转化为了左乘一个相同初等变换矩阵的操作。
:::info
也就是我们将单位矩阵进行`将第二行减去第一行的3倍`这个操作(专业用语叫做初等变换)。然后用我们的系数矩阵左乘这个矩阵，就得到了我们的结果矩阵。
:::
这个单位矩阵我们在21位置进行了初等变换，把它记作$E_{21}$。

![](/math/14.png =600x)

矩阵消元的第二步是完成矩阵`E21A`的第三行减去第二行的2倍，通过左乘矩阵`E32`来实现这一过程。

![](/math/15.png =600x)

:::info
相同的，我们需要进行的操作是`将第三行减去第二行的2倍`，于是我们对单位矩阵进行初等变换(将第三行减去第二行的2倍)，得到矩阵$E_{32}$，然后用系数矩阵左乘这个矩阵，就得到了我们的结果矩阵。 
:::

3x3矩阵的消元本来应该分三步完成，最终得到`E32(E31(E21A))`。本例中`E31=I`，所以结果变为`E32(E21 A)=U`，因为矩阵运算符合结合律，也可写作`(E32 E21)A=U`。可以记作`EA=U`。

方程$Ax=b$的解也可以满足$Ux=EAx=Eb=c$，因此我们可以转化为求$Ux=c$的解。
:::info
Eb=c的原因是，我们在消元的过程中，我们对等式右侧的b做了同样的乘法和加减法，所以我们的b也会发生变化。
:::
和前面一样，我们可以通过回代的方式求解出方程组的解。
$$
\begin{bmatrix} 1&2&1\\0&2&-2\\0&0&5 \end{bmatrix} \begin{bmatrix} x\\ y\\ z \end{bmatrix} = \begin{bmatrix} 2\\6\\-10 \end{bmatrix}
$$

## 置换矩阵

在消元的过程中，我们可能会遇到主元为0的情况，这时我们需要进行行交换，将非0行交换到主元所在的行，这样我们就可以进行消元了。

交换其实也很简单，我们只需要将单位矩阵的行进行交换即可。

左乘一个单位矩阵的行交换矩阵，就可以实现行交换的操作。右乘一个单位矩阵的列交换矩阵，就可以实现列交换的操作。
例如
- 行交换
$$
\begin{bmatrix} 0&1\\1&0\end{bmatrix} \begin{bmatrix} 1&2\\3&8 \end{bmatrix} = \begin{bmatrix} 3&8\\1&2 \end{bmatrix}
$$
- 列交换
$$
\begin{bmatrix} 1&2\\3&8 \end{bmatrix} \begin{bmatrix} 0&1\\1&0\end{bmatrix} = \begin{bmatrix} 2&1\\8&3 \end{bmatrix}
$$
- 三阶矩阵
$$
\begin{bmatrix} 0&0&1\\0&1&0\\1&0&0 \end{bmatrix} \begin{bmatrix} 1&2&1\\3&8&1\\0&4&1 \end{bmatrix} = \begin{bmatrix} 0&4&1\\3&8&1\\1&2&1 \end{bmatrix}
$$

左右乘效果不同也展示了矩阵运算不符合交换律的性质。

我们称这个矩阵为置换矩阵，置换矩阵的作用就是对矩阵的行或列进行交换。而置换矩阵就是单位矩阵进行行交换得到的。

## 逆矩阵Inverse
这里主要讨论消元矩阵的逆矩阵。消元矩阵之逆矩阵的实施效果就是抵消原矩阵的消元操作。消元矩阵实现了对原矩阵A的操作，使第二行行向量[3,8,1]减掉了第一行[1,2,1]的3倍变为[0,2,-2]，则逆向操作就应该是把现在的第二行行向量[0,2,-2]加上第一行[1,2,1]的3倍，从而变回原来的第二行[3,8,1]。

对于$E_{21}$= $\begin{bmatrix} 1&0&0\\-3&1&0\\0&0&1 \end{bmatrix}$，其逆矩阵为$\begin{bmatrix} 1&0&0\\3&1&0\\0&0&1 \end{bmatrix}$，记作$E_{21}^{-1}$。

满足$E_{21}^{-1}E_{21}=I$，$E_{21}E_{21}^{-1}=I$，即$\begin{bmatrix} 1&0&0\\-3&1&0\\0&0&1 \end{bmatrix}$ $\begin{bmatrix} 1&0&0\\3&1&0\\0&0&1 \end{bmatrix}$=$\begin{bmatrix} 1&0&0\\0&1&0\\0&0&1 \end{bmatrix}$


