---
order: 4
category: math
tag: 线性代数
star: false
sticky: false
excerpt: '线性代数-矩阵的LU分解'
---

# :boat:矩阵的LU分解

![](/math/28.png =700x)

本节的主要目的是从矩阵的角度理解高斯消元法，最后找到所谓的**L**矩阵，使得矩阵**A**可以转变为上三角阵**U**。即完成**LU**分解得到**A=LU**。

## 矩阵乘积的逆矩阵
假定矩阵**A** **B**均可逆，那么矩阵**AB**的逆矩阵是否存在?若存在，是什么？

其实这很简单，我们只需要证明$AB(AB)^{-1}=I$即可。

由于$AB$均可逆，所以$ABB^{-1}A^{-1}=AIA^{-1}=AA^{-1}=I$，所以$(AB)^{-1}=B^{-1}A^{-1}$。

## 转置矩阵
矩阵**A**的转置矩阵记为即$A^{T}$，对矩阵进行转置就是将**A**矩阵的行变为$A^{T}$的列，则完成后**A**的列也就成为了$A^{T}$的行，看起来矩阵如同沿着对角线进行了翻转。
$$
A=\begin{bmatrix} 1&2&3\\4&5&6 \end{bmatrix}A^{T}=\begin{bmatrix} 1&4\\2&5\\3&6 \end{bmatrix}
$$

- 矩阵乘积的转置 

$(AB)^{T}=B^{T}A^{T}$

我们可以用定义来证，下面的图也可以证明

![](/math/29.webp =700x)

- 转置矩阵的逆矩阵

$(A^{T})^{-1}=(A^{-1})^{T}$

$AA^{-1}=I$两边同时转置，得到$(A^{-1})^{T}A^{T}=I$，根据定义，$A^{T}$的逆矩阵为$(A^{-1})^{T}$

## 矩阵的LU分解
我们在对**A**进行消元时，将**A**左乘了一个矩阵**E**，使得**A**变为了上三角阵**U**，为了更好的研究矩阵**A**的性质，我们能不能将**A**分解为两个矩阵的乘积的形式，这就引出了矩阵的**LU**分解。

在没有行交换的情况下，矩阵**A**通过左乘一系列消元矩阵$E_{ij}$可以转化为**U**。在二阶矩阵中，进行一次消元操作即可达到这一效果。

![](/math/30.png =350x)

在等式两边左乘$E^{-1}_{21}$,得到$E^{-1}_{21}E_{21}A=E^{-1}_{21}U$,即$A=E^{-1}_{21}U$。这样我们就得到了二阶矩阵的**LU**分解。
:::info 
$E^{-1}_{21}$是$E_{21}$的逆向操作，即左乘$E_{21}$使得矩阵**A**第二行`[8,7]`减去第一行的4倍得到“新第二行”`[0,3]`，那么再左乘$E^{-1}_{21}$可以使得”新第二行”`[0,3]`加上“第一行”的4倍又变回原第二行的数值`[8,7]`。
:::

![](/math/31.png =350x)

其中**U**为上三角阵（Upper triangular matrix），主元依次排列于它的对角线上，$E^{-1}_{21}$即**L**为下三角阵（Lower triangular matrix）。有时我们也通过分解得到对角阵**D**（diagonal matrix）,例如

![](/math/32.png =450x)

对于三阶矩阵不需要换行的消元的情况有$E_{32}(E_{31}(E_{21}A))=U$，两边都左乘逆矩阵$E_{21}^{-1}E_{31}^{-1}E_{32}^{-1}E_{32}E_{31}E_{21}A=E_{21}^{-1}E_{31}^{-1}E_{32}^{-1}U$，即$A=E_{21}^{-1}E_{31}^{-1}E_{32}^{-1}U=LU$

> 注意逆矩阵的顺序，逆矩阵的顺序和矩阵的顺序是相反的

设定一组消元矩阵，其中$E_{31}$为单位阵**I**，其它两个消元矩阵如下：

![](/math/33.png =350x)

可以看到在消元矩阵E的左下角出现了数10。它的出现是由于第一步操作$E_{21}$中“第二行”减去了2倍的“第一行”得到了“新第二行”,而在第二步操作E32中第三行减去了5倍的“新第二行”，这相当于减去5倍的“原第二行”并减去5倍的“（-2）倍原第一行”，10就出现在这里。

在右侧操作则不会有这种情况发生，运算顺序会发生变化，$L=E^{-1}=E_{21}^{-1}E_{32}^{-1}$

![](/math/34.png =350x)

如果没有行交换操作，则消元矩阵的因子可以直接写入矩阵**L**。没有多余的交叉项出现是**LU**分解要优于**EA=U**这种形式的原因之一。

## 消元法所需运算量
在一些应用中我们需要处理超大型矩阵，即使用计算机来处理这一问题，也需要评估所需的计算量。

如果我们把“先乘后减”大致记为一次运算，那么对于一个**nxn**矩阵，对于一行进行消元要进行n次运算，由于有n行所以进行了nxn次运算(要将除第一行外所有数字进行操作，为了化简，我们加上第一行为n)，结果得到了第一列除第一主元外都消成0的矩阵。随后开始对除第一行第一列之外的剩余部分进行消元，这相当于一个(n-1)x(n-1)的矩阵，那么就要进行(n-1)x(n-1)次运算，以此类推。

最后需要的运算次数为1x1+2x2+……+nxn，利用积分公式可以估算其数值。

![](/math/35.png =350x)

## 置换矩阵
如果主元的位置出现了0，就需要进行“行交换”。我们可以通过左乘一个置换矩阵（Permutation Matrix）实现“行交换”的操作。例如

![](/math/36.png =150x)

可以实现33矩阵的第一行与第二行的交换。所有的33的置换矩阵包括：

![](/math/37.png =650x)

对于nxn矩阵存在着n！个置换矩阵。

:::info

置换矩阵每一行或者每一列只有一个元素是1，其它都是0，从第一行选一个位置设定为1有n个选择，第二行则只剩下n-1个选择，以此类推，最终有n！种可能。

:::
对于某阶的置换矩阵集合而言，置换矩阵的两两乘积仍在这个集合中，置换矩阵的逆矩阵也在此集合中。置换矩阵的逆矩阵即为它的转置$P^{-1}=P^{T}$。



