---
order: 15
category: math
tag: 线性代数
star: false
sticky: false
excerpt: '线性代数-投影矩阵和最小二乘法'
---

# :boat:投影矩阵和最小二乘法
Projection matrices and least squares

## 投影 Projections

上一讲我们推到出来了投影矩阵$P=A(A^TA)^{-1}A^T$，当它作用于向量**b**，相当于把**b**投影到矩阵**A**的列空间。

如果向量**b**本身就在**A**的列空间内，即存在**x**使得**Ax=b**，则有：
$$
\begin{align*}
Pb &=A(A^TA)^{-1}A^Tb\\
&=A(A^TA)^{-1}A^TAx\\
&=Ax\\
&=b
\end{align*}
$$
如果向量**b**与**A**的列空间正交，即向量**b**在矩阵**A**的左零空间N(**A**^T^)内，则有：
$$
\begin{align*}
Pb &=A(A^TA)^{-1}A^Tb\\
&=A(A^TA)^{-1}(A^Tb)\\
&=A(A^TA)^{-1}0\\
&=0
\end{align*}
$$

![](/math/89.png =1000x)


> **e**=**b**-**p**=**Ib**-**Pb**=(**I**-**P**)**b**

## 最小二乘法 Least squares
应用投影矩阵求方程组最优解的方法，最常用于“最小二乘法”拟合曲线。

![](/math/90.png =500x)

三个点{(1,1), (2,2), (3,2)}，求直线方程b=C+Dt，要求直线尽量接近于三个点。
- C+ D=1
- C+2D=2
- C+3D=2

矩阵形式为：$\begin{bmatrix}1&1\\1&2\\1&3\end{bmatrix}\begin{bmatrix}C\\D\end{bmatrix}=\begin{bmatrix}1\\2\\2\end{bmatrix}$

很明显，这个方程**Ax=b**是无解的。解决方法就是求其最优解，最优解的含义即为误差最小，这里误差就是每个方程误差值的平方和$\left\| e \right\|^{2}=\left\| A\hat{x}-b \right\|^{2}$
因此就是寻找具有最小误差平方和的解$\hat{x}$，这就是所谓的“最小二乘”问题。

从几何上讨论求解过程，就是试图寻找数据点到直线距离的平方和$e^{2}_{1}+e^{2}_{2}+e^{2}_{3}$最小的情况，此时得到的C+Dt分别为p1，p2和p3，它们是满足方程并最接近于**b**的结果。另一种看法是，对于**R**3空间上的向量**b**，它投影到矩阵**A**的列空间中会得到向量**p**=[p1 p2 p3]，投影到矩阵**A**的零空间中则为**e**。

![](/math/91.png =1000x)

得到直线表达式y=2/3+t/2。将t=1, 2, 3分别代入可得：

![](/math/92.png =500x)

可以验证，向量p与e正交，并且e与矩阵A的列空间正交。

## 矩阵A^T^A

![](/math/93.png =1000x)